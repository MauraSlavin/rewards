$(document).ready(()=>{let e=[],t='<img class="responsive-img" ';t+='src="assets/css/images/checkClear.png" ',t+='alt="checkmark">';let s='<img class="responsive-img" ';s+='src="assets/css/images/remove.png" ',s+='alt="remove">';let a=0;!function(){var e;e=1,$.get(`api/kids/${e}`,e=>{$(".greetname").text(e.name),a=e.points,$("#ptbalance").text(a)}),console.log("Child greeted by name."),function(){let e="",t="";t+='<div class="card light-blue lighten-2">',t+='<button class="waves-effect waves-light hoverable z-depth-2 choreicon" ',$.get("api/chores",t=>{t.forEach(t=>{e='<div class="card light-blue lighten-2"><button class="waves-effect waves-light hoverable z-depth-2 choreicon" ',e+=`data-id="${t.id}" data-title="${t.title}" data-file="${t.iconfile}" data-points="${t.points}"> `,e+='<img class="responsive-img" ',e+=`src="assets/css/images/${t.iconfile}" `,e+=`alt="${t.title}">`,e+=`${t.points}`,e+="</img></button></div>",$(".column1").append(e)})}).catch(e=>{console.log(e)})}(),console.log("Chore Icons in column 1 loaded."),$.get("api/kids",e=>{let t="";e.forEach(e=>{t=`<li><a href="kid.html">${e.name}</a></li>`,$(".kidlinks").append(t)})}),console.log("Children's names are in dropdown list."),function(){let e="";$.get("api/parents",t=>{t.forEach(t=>{e=`<li><a href="parent.html">${t.name}</a></li>`,$(".parentlinks").append(e)})})}(),console.log("Parents' names are in dropdown list."),function(e){let a="",o="",i="",c="",l="",n="",d="";o='<div class="col s4 left"> ',o+='<button class="waves-effect waves-light hoverable z-depth-2 checkicon" ',c='<div class="col s4 left"> ',c+='<button class="waves-effect waves-light hoverable z-depth-2 checkbutton" ',n='<div class="col s4 left"> ',n+='<button class="waves-effect waves-light red hoverable z-depth-2 removebutton" ',$.get(`api/assignedchores/${e}`,e=>{e.forEach(e=>{a='<div class="row flex">',i='<div class="col s4 left"> <button class="waves-effect waves-light hoverable z-depth-2 checkicon" ',i+=`data-id="${e.id}" `,i+=`data-choreid="${e.ChoreId}" `,i+=`data-points="${e.Chore.points}"> `,i+='<img class="responsive-img" ',i+=`src="assets/css/images/${e.Chore.iconfile}" `,i+=`alt="${e.Chore.title}">`,i+=`${e.Chore.points}`,a+=i+="</img></button></div>",l='<div class="col s4 left"> <button class="waves-effect waves-light hoverable z-depth-2 checkbutton" ',l+=`data-id="${e.id}" `,l+=`data-choreid="${e.ChoreId}" `,l+=`data-points="${e.Chore.points}"> `,l+=t,a+=l+="</button></div>",d='<div class="col s4 left"> <button class="waves-effect waves-light red hoverable z-depth-2 removebutton" ',d+=`data-id="${e.id}" `,d+=`data-choreid="${e.ChoreId}"> `,d+=s,a+=d+="</button></div>",a+="</div>",$(".column2icons").append(a)})}).catch(e=>{console.log(e)})}(1),console.log("To Do list is loaded."),$(".request").attr("disabled",!0),$(".approve").attr("disabled",!0)}(),console.log("Page is done loading."),$(".approve").click(()=>{console.log("Parent Approvel butten has been clicked."),function(t){let s=0;e.forEach(e=>{s+=e.points,$.ajax({method:"DELETE",url:`/api/assignedchores/${e.id}`}).then(()=>{console.log(`Chore:${e.id} deleted from AssignedChores.`)}).then(()=>{$.ajax({method:"PUT",url:`/api/kids/1/add/${e.points}`}).then(()=>{$.ajax({method:"POST",url:`/api/donechores/1/${e.choreId}`})}).catch(e=>{console.log(e)})})}),$("#ptsearned").text(s),a+=s,$("#ptbalance").text(a),$(".todelete").remove(),e=[],$(".request").attr("disabled",!0),$(".approve").attr("disabled",!0)}()}),$(".request").click(()=>{console.log("Request parental approval was clicked."),$.ajax({method:"GET",url:"/api/emailChild"}).then(()=>{console.log("An email has been sent to the parent.")}).catch(e=>{console.log(e)}),function(e){$(".request").attr("disabled",!0),$(".approve").attr("disabled",!1)}()}),$(".column2icons").on("click",".checkbutton",function(t){console.log("A checkmark has been clicked."),$(".request").attr("disabled",!1),$(this).find("img").attr("src","assets/css/images/checkGreen.png"),$(this).attr("disabled",!0),$(this).parent().parent().addClass("todelete");const s={id:$(this).data("id"),choreId:$(this).data("choreid"),points:$(this).data("points")};e.push(s)}),$(".column2icons").on("click",".checkicon",function(t){console.log("A checkmark icon has been clicked."),$(".request").attr("disabled",!1),$(this).parent().parent().addClass("todelete").find(".checkbutton").attr("disabled",!0).find("img").attr("src","assets/css/images/checkGreen.png"),$(this).attr("disabled",!0);const s={id:$(this).data("id"),choreId:$(this).data("choreid"),points:$(this).data("points")};e.push(s)}),$(".column2icons").on("click",".removebutton",function(t){console.log("A remove button has been clicked.");const s=$(this).data("id");$(this).data("choreid");$(this).parent().parent().remove(),e=$.grep(e,(e,t)=>e.id==s,!0),$.ajax({method:"DELETE",url:`/api/assignedchores/${s}`}).then(()=>{console.log(`Chore:${s} deleted from AssignedChores.`)}).catch(e=>{console.log(e)}),0===e.length&&$(".request").attr("disabled",!0)}),$(".column1").on("click",".choreicon",function(e){console.log("An icon has been clicked to assign a chore.");const a=$(this).data("id"),o=$(this).data("file"),i=$(this).data("title"),c=$(this).data("points");let l="";$.ajax({method:"POST",url:`/api/assignedchores/1/${a}`}).then(e=>{console.log(`Chore ${a} written to assigned chores table for child 1.`),l=e.id}).then(()=>{let e='<div class="row flex">';e+='<div class="col s4 left"> ',e+='<button class="waves-effect waves-light hoverable z-depth-2 checkicon" ',e+=`data-id="${l}" `,e+=`data-choreid="${a}" `,e+=`data-points="${c}"> `,e+='<img class="responsive-img" ',e+=`<img src="assets/css/images/${o}" `,e+=`alt="${i}">`,e+=`${c}`,e+="</img></button></div>",e+='<div class="col s4 left"> ',e+='<button class="waves-effect waves-light hoverable z-depth-2 checkbutton" ',e+=`data-id="${l}" `,e+=`data-choreid="${a}" `,e+=`data-points="${c}"> `,e+=t,e+="</button></div>",e+='<div class="col s4 left"> ',e+='<button class="waves-effect waves-light red hoverable z-depth-2 removebutton" ',e+=`data-id="${l}" `,e+=`data-choreid="${a}"> `,e+=s,e+="</button></div>",e+="</div></div>",$(".column2icons").append(e)}).catch(()=>{console.log(`Error writing chore ${a} to assigned chores table.`)})})});