let ptsBalance=0;function loadRewardIcons(){console.log("Loading rewards icons. Only eligible ones will be clickable.");let e="";$.get("api/rewards",a=>{a.forEach(a=>{e='<div class="col s12 m2 todelete light-blue lighten-2"> <div class="row flex">',e+='<button class="waves-effect waves-light hoverable z-depth-2 rewardBtn" ',e+=`data-id="${a.id}" `,e+=`data-points="${a.points}" `,a.points>ptsBalance?e+='disabled="disabled"> ':e+="> ",e+='<img class="responsive-img" ',e+='class="icons" ',e+=`src="assets/css/images/${a.iconfile}" `,e+=`alt="${a.title}">`,e+=`${a.title} - ${a.points}`,e+="</img></button></div></div>",$(".rewardicons").append(e)})}).catch(e=>{console.log(e)})}function loadChildrenNames(){$.get("api/kids",e=>{let a="";e.forEach(e=>{a=`<li><a href="kid.html">${e.name}</a></li>`,$(".kidlinks").append(a)})})}function loadParentNames(){let e="";$.get("api/parents",a=>{a.forEach(a=>{e=`<li><a href="parent.html">${a.name}</a></li>`,$(".parentlinks").append(e)})})}function greetChildLoadRewards(e){$.get(`api/kids/${e}`,e=>{$(".greetname").text(e.name),ptsBalance=e.points,$("#ptbalance").text(ptsBalance)}).then(()=>{loadRewardIcons()}).catch(e=>{console.log(e)})}greetChildLoadRewards(1),loadChildrenNames(),loadParentNames(),$(document).ready(()=>{$(document).on("click",".rewardBtn",function(e){e.preventDefault();const a=$(this).data("id"),t=$(this).data("points"),n=$(this).clone();$("#reward-display").html(n).find(".rewardBtn").addClass("rewardChosen"),$(".rewardChosen").find("img").siblings().remove(),$("#reward-submit").attr("disabled",!1).attr("data-id",a).attr("data-points",t),$("#choose-txt").text("Submit Your Reward!")}),$("#reward-submit").on("click",function(e){e.preventDefault();const a=$(this).parent().parent().find(".rewardBtn"),t=$(a[0]).data("id"),n=$(a[0]).data("points");$.ajax({method:"POST",url:`/api/usedpoints/1/${t}`}).then(()=>{$.ajax({method:"PUT",url:`/api/kids/1/sub/${n}`}).then(()=>{ptsBalance-=n,$("#ptbalance").text(ptsBalance)}).then(()=>{$(".todelete").remove(),$("#reward-submit").attr("disabled",!0),$("#choose-txt").text("Choose your reward."),$(".rewardChosen").remove(),loadRewardIcons()}).catch(e=>{console.log(e)})})})});
